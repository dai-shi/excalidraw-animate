(this["webpackJsonpexcalidraw-animate"]=this["webpackJsonpexcalidraw-animate"]||[]).push([[0],{19:function(t,e,n){},20:function(t,e,n){},45:function(t,e,n){},46:function(t,e,n){},48:function(t,e,n){},49:function(t,e,n){"use strict";n.r(e);var r=n(2),a=n.n(r),c=n(12),i=n.n(c),o=(n(19),n(20),n(4)),u=n(6),s=n(0),l=n.n(s),f=n(3),b=n(7),d=n(5),p=(n(45),n(46),n(1)),h=function(t){var e=t.link,n=t.size,r=t.fill,a=t.color;return Object(p.jsx)("a",{href:e,className:"GitHubCorner-container","aria-label":"View source on GitHub",target:"_blank",rel:"noopener noreferrer",children:Object(p.jsxs)("svg",{width:n||80,height:n||80,viewBox:"0 0 250 250",style:{fill:r||"#151513",color:a||"#fff",position:"absolute",top:0,border:0,right:0},"aria-hidden":"true",children:[Object(p.jsx)("path",{d:"M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"}),Object(p.jsx)("path",{d:"M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2",fill:"currentColor",style:{transformOrigin:"130px 106px"},className:"GitHubCorner-octo-arm"}),Object(p.jsx)("path",{d:"M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z",fill:"currentColor",className:"GitHubCorner-octo-body"})]})})},m=n(13),v="http://www.w3.org/2000/svg",g=function(t,e,n,r,a){e.setAttribute("opacity","0");var c=t.ownerDocument.createElementNS(v,"animate");c.setAttribute("attributeName","opacity"),c.setAttribute("from","1"),c.setAttribute("to","1"),c.setAttribute("begin","".concat(n,"ms")),c.setAttribute("dur","".concat(r,"ms")),a&&c.setAttribute("fill","freeze"),e.appendChild(c)},w=function(t,e,n,r,a,c){var i;if(c.pointerImg){var u=t.ownerDocument.createElementNS(v,"image");u.setAttribute("href",c.pointerImg),c.pointerWidth&&u.setAttribute("width",c.pointerWidth),c.pointerHeight&&u.setAttribute("height",c.pointerHeight),g(t,u,r,a);var s=t.ownerDocument.createElementNS(v,"animateMotion");s.setAttribute("path",function(t){var e=t.match(/(M[^C]*C[^M]*)/g);if(!e)return t;if(e.length<=2)return e[e.length-1];var n=e.reduce((function(t,e,n){var r=e.match(/M([\d.-]+) ([\d.-]+) C([\d.-]+) ([\d.-]+)/)||[],a=Object(o.a)(r,5),c=a[1],i=a[2],u=a[3],s=a[4],l=Math.hypot(Number(u)-Number(c),Number(s)-Number(i));return l>t[1]?[n,l]:t}),[0,0]);return e[Object(o.a)(n,1)[0]]}(n)),s.setAttribute("begin","".concat(r,"ms")),s.setAttribute("dur","".concat(a,"ms")),u.appendChild(s),null===(i=e.parentNode)||void 0===i||i.appendChild(u)}},j=function(t,e,n,r,a){for(var c,i,u=e.getAttribute("d")||"",s=(null===(c=u.match(/M/g))||void 0===c?void 0:c.length)||0,l=((null===(i=u.match(/C/g))||void 0===i?void 0:i.length)||0)/s,f=u,b=function(a){var c=u.replace(new RegExp(["M(\\S+) (\\S+)","((?: C\\S+ \\S+, \\S+ \\S+, \\S+ \\S+){","".concat(a),"})","(?: C\\S+ \\S+, \\S+ \\S+, \\S+ \\S+){1,}"].join(""),"g"),(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[3]?e[3].match(/.* (\S+) (\S+)$/).slice(1,3):[e[1],e[2]],c=Object(o.a)(r,2),i=c[0],u=c[1];return"M".concat(e[1]," ").concat(e[2]).concat(e[3])+" C".concat(i," ").concat(u,", ").concat(i," ").concat(u,", ").concat(i," ").concat(u).repeat(l-a)}));0===a&&e.setAttribute("d",c);var i=t.ownerDocument.createElementNS(v,"animate");i.setAttribute("attributeName","d"),i.setAttribute("from",c),i.setAttribute("to",f),i.setAttribute("begin","".concat(n+a*(r/l),"ms")),i.setAttribute("dur","".concat(r/l,"ms")),i.setAttribute("fill","freeze"),e.appendChild(i),f=c},d=l-1;d>=0;d-=1)b(d);w(t,e,u,n,r,a),g(t,e,n,r,!0)},x=function(t,e,n,r,a){var c=e.getAttribute("d")||"";if(c.includes("C"))j(t,e,n,r,a);else{var i=c.replace(new RegExp(["M(\\S+) (\\S+)","((?: L\\S+ \\S+){1,})"].join("")),(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return"M".concat(e[1]," ").concat(e[2])+e[3].replace(/L\S+ \S+/g,"L".concat(e[1]," ").concat(e[2]))}));e.setAttribute("d",i);var o=t.ownerDocument.createElementNS(v,"animate");o.setAttribute("attributeName","d"),o.setAttribute("from",i),o.setAttribute("to",c),o.setAttribute("begin","".concat(n,"ms")),o.setAttribute("dur","".concat(r,"ms")),o.setAttribute("fill","freeze"),e.appendChild(o)}},O=function(t,e,n,r,a){var c,i,s,l,f=e.getAttribute("d")||"",b=(null===(c=f.match(/M/g))||void 0===c?void 0:c.length)||0,d=(null===(i=f.match(/C/g))||void 0===i?void 0:i.length)||0;b===d+1&&(b=(null===(s=(f=f.replace(/^M\S+ \S+ M/,"M")).match(/M/g))||void 0===s?void 0:s.length)||0,d=(null===(l=f.match(/C/g))||void 0===l?void 0:l.length)||0);if(b!==d)throw new Error("unexpected m/c counts");for(var p=e.getAttribute("stroke-dasharray")?1:Math.min(2,b),h=b/p,m=f,j=function(c){var i=f.replace(new RegExp(["((?:","M(\\S+) (\\S+) C\\S+ \\S+, \\S+ \\S+, \\S+ \\S+ ?".repeat(p),"){","".concat(c),"})","M(\\S+) (\\S+) C\\S+ \\S+, \\S+ \\S+, \\S+ \\S+ ?".repeat(p),".*"].join("")),(function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return"".concat(e[1])+Object(u.a)(Array(p).keys()).map((function(t){var n=e.slice(2+2*p+2*t),r=Object(o.a)(n,2),a=r[0],c=r[1];return"M".concat(a," ").concat(c," C").concat(a," ").concat(c,", ").concat(a," ").concat(c,", ").concat(a," ").concat(c," ")})).join("").repeat(h-c)}));0===c&&e.setAttribute("d",i);var s=t.ownerDocument.createElementNS(v,"animate");s.setAttribute("attributeName","d"),s.setAttribute("from",i),s.setAttribute("to",m),s.setAttribute("begin","".concat(n+c*(r/h),"ms")),s.setAttribute("dur","".concat(r/h,"ms")),s.setAttribute("fill","freeze"),e.appendChild(s),m=i,w(t,e,f.replace(new RegExp(["(?:","M\\S+ \\S+ C\\S+ \\S+, \\S+ \\S+, \\S+ \\S+ ?".repeat(p),"){","".concat(c),"}","(M\\S+ \\S+ C\\S+ \\S+, \\S+ \\S+, \\S+ \\S+) ?".repeat(p),".*"].join("")),"$1"),n+c*(r/h),r/h,a)},x=h-1;x>=0;x-=1)j(x);g(t,e,n,r,!0)},S=0,A=function(t,e,n,r,a,c){var i=t.ownerDocument.createElementNS(v,"path"),o=t.ownerDocument.createElementNS(v,"animate");o.setAttribute("attributeName","d"),o.setAttribute("from",n),o.setAttribute("to",r),o.setAttribute("begin","".concat(a,"ms")),o.setAttribute("dur","".concat(c,"ms")),i.appendChild(o),e.appendChild(i)},y=function(t,e,n,r,a,c){var i=e.childNodes,o=i.length;i.forEach((function(e){!function(t,e,n,r,a,c){var i;if("start"!==(n.getAttribute("text-anchor")||"start")){var o=n.getAttribute("opacity")||"1.0",u=t.ownerDocument.createElementNS(v,"animate");return u.setAttribute("attributeName","opacity"),u.setAttribute("from","0.0"),u.setAttribute("to",o),u.setAttribute("begin","".concat(r,"ms")),u.setAttribute("dur","".concat(a,"ms")),u.setAttribute("fill","freeze"),n.appendChild(u),void n.setAttribute("opacity","0.0")}var s=Number(n.getAttribute("x")||0),l=Number(n.getAttribute("y")||0);S+=1;var f=t.ownerDocument.createElementNS(v,"path");f.setAttribute("id","pathForText"+S);var b=t.ownerDocument.createElementNS(v,"animate");b.setAttribute("attributeName","d"),b.setAttribute("from","m".concat(s," ").concat(l," h0")),b.setAttribute("to","m".concat(s," ").concat(l," h").concat(e)),b.setAttribute("begin","".concat(r,"ms")),b.setAttribute("dur","".concat(a,"ms")),b.setAttribute("fill","freeze"),f.appendChild(b);var d=t.ownerDocument.createElementNS(v,"textPath");d.setAttribute("href","#pathForText"+S),d.textContent=n.textContent,n.textContent=" ",null===(i=function(t,e){for(var n=t.childNodes,r=0;r<n.length;++r)if(n[r].tagName===e)return n[r];return null}(t,"defs"))||void 0===i||i.appendChild(f),n.appendChild(d),w(t,n,"m".concat(s," ").concat(l," h").concat(e),r,a,c)}(t,n,e,r,a/o,c),r+=a/o}))},C=function(t,e,n,r,a,c){var i=n.type,u=n.strokeSharpness,s=n.width;"line"===i?function(t,e,n,r,a,c){var i="sharp"!==n?j:O,o=e.childNodes;o[0].getAttribute("fill-rule")?(i(t,o[0].childNodes[1],r,.75*a,c),r+=.75*a,x(t,o[0].childNodes[0],r,.25*a,c)):i(t,o[0].childNodes[0],r,a,c)}(t,e,u,r,a,c):"arrow"===i?function(t,e,n,r,a,c){var i="sharp"!==n?j:O,o=e.childNodes.length;i(t,e.childNodes[0].childNodes[0],r,a/(o+2)*3,c),r+=a/(o+2)*3;for(var u=1;u<o;u+=1)for(var s=e.childNodes[u].childNodes.length,l=0;l<s;l+=1)j(t,e.childNodes[u].childNodes[l],r,a/(o+2)/s,c),r+=a/(o+2)/s}(t,e,u,r,a,c):"rectangle"===i||"diamond"===i?function(t,e,n,r,a){e.childNodes[1]?(O(t,e.childNodes[1],n,.75*r,a),n+=.75*r,x(t,e.childNodes[0],n,.25*r,a)):O(t,e.childNodes[0],n,r,a)}(t,e,r,a,c):"ellipse"===i?function(t,e,n,r,a){e.childNodes[1]?(j(t,e.childNodes[1],n,.75*r,a),n+=.75*r,x(t,e.childNodes[0],n,.25*r,a)):j(t,e.childNodes[0],n,r,a)}(t,e,r,a,c):"text"===i?y(t,e,s,r,a,c):"freedraw"===n.type?function(t,e,n,r,a,c){var i=e.childNodes[0];i.setAttribute("opacity","0");var u=t.ownerDocument.createElementNS(v,"animate");u.setAttribute("attributeName","opacity"),u.setAttribute("from","0"),u.setAttribute("to","1"),u.setAttribute("calcMode","discrete"),u.setAttribute("begin","".concat(r+a-1,"ms")),u.setAttribute("dur","".concat(1,"ms")),u.setAttribute("fill","freeze"),i.appendChild(u),w(t,i,n.points.reduce((function(t,e){var n=Object(o.a)(e,2),r=n[0],a=n[1];return t?t+" T ".concat(r," ").concat(a):"M ".concat(r," ").concat(a)}),""),r,a,c);for(var s=n.points.length,l=i.getAttribute("d"),f=s-1;f>=0;f-=1){var b=f>0?Object(d.getFreeDrawSvgPath)(Object(m.a)(Object(m.a)({},n),{},{points:n.points.slice(0,f)})):"M 0 0";A(t,e,b,l,r+f*(a/s),a/s),l=b}}(t,e,n,r,a,c):"image"===i?function(t,e,n,r){var a=e.getAttribute("opacity")||"1.0",c=t.ownerDocument.createElementNS(v,"animate");c.setAttribute("attributeName","opacity"),c.setAttribute("from","0.0"),c.setAttribute("to",a),c.setAttribute("begin","".concat(n,"ms")),c.setAttribute("dur","".concat(r,"ms")),c.setAttribute("fill","freeze"),e.appendChild(c),e.setAttribute("opacity","0.0")}(t,e,r,a):console.error("unknown excalidraw element type",n.type)},N=function(t,e){var n={},r=0;return t.childNodes.forEach((function(t){if("g"===t.tagName){var a=e[r].groupIds;if(a.length>=1){var c=a[0];n[c]=n[c]||[],n[c].push([t,r])}r+=1}})),n},k=function(t){return Object(u.a)(t).filter((function(t){return"g"===t.tagName||"use"===t.tagName}))},E=function(t,e){var n=t.id.match(new RegExp("".concat(e,":(-?\\d+)")));return n&&Number(n[1])||0},M=function(t,e){return Object(u.a)(t).sort((function(n,r){var a=t.indexOf(n),c=t.indexOf(r);return E(e[a],"animateOrder")-E(e[c],"animateOrder")}))},L=function(t,e){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=N(t,e),c=new Map,i=null!==(n=r.startMs)&&void 0!==n?n:1e3,u=5e3,s=500,l=k(t.childNodes);if(l.length!==e.length)throw new Error("element length mismatch");var f=new Map(l.map((function(t,n){return[t,e[n]]})));return M(l,e).forEach((function(n){var l=f.get(n),b=l.groupIds;if(!c.has(n))if(b.length>=1){var d=b[0],p=a[d],h=E(l,"animateDuration")||u/(p.length+1);C(t,n,l,i,h,r),i+=h,c.set(n,!0),p.forEach((function(n){var a=Object(o.a)(n,2),s=a[0],l=a[1],f=E(e[l],"animateDuration")||u/(p.length+1);c.has(s)||(C(t,s,e[l],i,f,r),i+=f,c.set(s,!0))})),delete a[d]}else{var m=E(l,"animateDuration")||s;C(t,n,l,i,m,r),i+=m,c.set(n,!0)}})),{finishedMs:i+1e3}},T=function(){var t=Object(f.a)(l.a.mark((function t(e){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.getCurrentTime(),e.setCurrentTime(0),r=(new XMLSerializer).serializeToString(e),e.setCurrentTime(n),t.next=6,Object(b.b)(new Blob([r],{type:"image/svg+xml"}),{fileName:"excalidraw-animate.svg",extensions:[".svg"]});case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=function(){var t=Object(f.a)(l.a.mark((function t(e){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(b.b)(new Blob([e],{type:"video/webm"}),{fileName:"excalidraw-animate.webm",extensions:[".webm"]});case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),R=function(t){return new Promise(function(){var e=Object(f.a)(l.a.mark((function e(n,r){var a,c,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getDisplayMedia({video:{cursor:"never",displaySurface:"browser"}});case 3:a=e.sent,(c=new MediaRecorder(a)).ondataavailable=function(t){n(t.data)},i=0,t.forEach((function(t){var e=t.svg,n=t.finishedMs;i=Math.max(i,n),e.pauseAnimations(),e.setCurrentTime(0)})),c.start(),t.forEach((function(t){t.svg.unpauseAnimations()})),setTimeout((function(){c.stop(),a.getVideoTracks()[0].stop()}),i),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),r(e.t0);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t,n){return e.apply(this,arguments)}}())},P=function(t,e){return window.crypto.subtle.importKey("jwk",{alg:"A128GCM",ext:!0,k:t,key_ops:["encrypt","decrypt"],kty:"oct"},{name:"AES-GCM",length:128},!1,[e])},z=function(){var t=Object(f.a)(l.a.mark((function t(e,n,r){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(r,"decrypt");case 2:return a=t.sent,t.abrupt("return",window.crypto.subtle.decrypt({name:"AES-GCM",iv:e},a,n));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),I=function(){var t=Object(f.a)(l.a.mark((function t(e,n){var r,a,c,i,o,u,s,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(n?"".concat("https://json.excalidraw.com/api/v2/").concat(e):"".concat("https://json.excalidraw.com/api/v1/").concat(e,".json"));case 3:if((r=t.sent).ok){t.next=7;break}return window.alert("alerts.importBackendFailed"),t.abrupt("return",{});case 7:if(!n){t.next=29;break}return t.next=10,r.arrayBuffer();case 10:return c=t.sent,t.prev=11,o=c.slice(0,12),u=c.slice(12,c.byteLength),t.next=16,z(o,u,n);case 16:i=t.sent,t.next=25;break;case 19:return t.prev=19,t.t0=t.catch(11),s=new Uint8Array(12),t.next=24,z(s,c,n);case 24:i=t.sent;case 25:f=new window.TextDecoder("utf-8").decode(new Uint8Array(i)),a=JSON.parse(f),t.next=32;break;case 29:return t.next=31,r.json();case 31:a=t.sent;case 32:return t.abrupt("return",{elements:a.elements||null,appState:a.appState||null});case 35:return t.prev=35,t.t1=t.catch(0),window.alert("alerts.importBackendFailed"),console.error(t.t1),t.abrupt("return",{});case 40:case"end":return t.stop()}}),t,null,[[0,35],[11,19]])})));return function(e,n){return t.apply(this,arguments)}}(),B=function(){var t=Object(f.a)(l.a.mark((function t(e,n,r){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==e){t.next=10;break}return t.t0=d.restore,t.next=4,I(e,n);case 4:t.t1=t.sent,t.t2=null===r||void 0===r?void 0:r.appState,t.t3=null===r||void 0===r?void 0:r.elements,a=(0,t.t0)(t.t1,t.t2,t.t3),t.next=11;break;case 10:a=Object(d.restore)(r||null,null,null);case 11:return t.abrupt("return",{elements:a.elements,appState:a.appState,files:a.files,commitToHistory:!1});case 12:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),H=function(){var t=Object(f.a)(l.a.mark((function t(e){var n,r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(d.loadLibraryFromBlob)(e);case 2:if((n=t.sent)&&!n.libraryItems){t.next=5;break}return t.abrupt("return",n);case 5:return(r=n.library)&&(a=[],r.forEach((function(t){a.push({elements:t})})),n.libraryItems=a),t.abrupt("return",n);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),F=function(t){return t.filter((function(t){return!t.isDeleted}))},G=function(){var t=Object(f.a)(l.a.mark((function t(e){var n,r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:return n=t.sent,t.next=6,n.blob();case 6:return r=t.sent,t.next=9,H(r);case 9:if((a=t.sent)&&a.libraryItems){t.next=12;break}throw new Error;case 12:return t.abrupt("return",a.libraryItems.map((function(t){return F(Object(d.restoreElements)(t.elements,null))})));case 15:return t.prev=15,t.t0=t.catch(0),window.alert("Unable to load library"),t.abrupt("return",[]);case 19:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e){return t.apply(this,arguments)}}(),U=function(){var t=Object(f.a)(l.a.mark((function t(){var e;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(b.a)({description:"Excalidraw files"});case 2:return e=t.sent,t.abrupt("return",Object(d.loadFromBlob)(e,null,null));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),W=/#json=([0-9]+),?([a-zA-Z0-9_-]*)|^http.*\.excalidrawlib$/,V=function(t){var e,n=(e=[]).concat.apply(e,Object(u.a)(t.map((function(t){return function(t){var e=[],n=[],r=function t(e){if("animate"===e.tagName){var r=/([0-9.]+)ms/.exec(e.getAttribute("begin")||"");r&&n.push(Number(r[1]))}e.childNodes.forEach((function(e){t(e)}))};return t.childNodes.forEach((function(t){"g"===t.tagName?(r(t),n.length&&(e.push(Math.min.apply(Math,n)),n.splice(0))):"defs"===t.tagName&&t.childNodes.forEach((function(t){r(t),n.length&&(e.push(Math.min.apply(Math,n)),n.splice(0))}))})),e}(t.svg).map((function(t){return 100*Math.floor(t/100)}))}))));return Object(u.a)(new Set(n)).sort((function(t,e){return t-e}))},Z=function(t){var e=t.svgList,n=t.loadDataList,a=Object(r.useState)(!1),c=Object(o.a)(a,2),i=c[0],u=c[1],s=Object(r.useState)(!1),m=Object(o.a)(s,2),v=m[0],g=m[1],w=Object(r.useState)(!1),j=Object(o.a)(w,2),x=j[0],O=j[1],S=Object(r.useState)(""),A=Object(o.a)(S,2),y=A[0],C=A[1],N=Object(r.useState)(),k=Object(o.a)(N,2),E=k[0],M=k[1];Object(r.useEffect)((function(){M(void 0)}),[e]),Object(r.useEffect)((function(){e.forEach((function(t){var e=t.svg;v?e.pauseAnimations():e.unpauseAnimations()}))}),[e,v]),Object(r.useEffect)((function(){var t=window.location.hash.slice(1);"no"!==new URLSearchParams(t).get("toolbar")?u(!0):u("never")}),[]);var L=function(){var t=Object(f.a)(l.a.mark((function t(){var e;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U();case 2:e=t.sent,n([e]);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),P=function(){var t=Object(f.a)(l.a.mark((function t(){var e,r,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(b.a)({description:"Excalidraw library files",extensions:[".json",".excalidrawlib"],mimeTypes:["application/json"]});case 2:return e=t.sent,t.next=5,H(e);case 5:if((r=t.sent)&&r.libraryItems){t.next=9;break}return window.alert("Unable to load library"),t.abrupt("return");case 9:a=r.libraryItems.map((function(t){return F(Object(d.restoreElements)(t.elements,null))})),n(a.map((function(t){return{elements:t,files:{}}})));case 11:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),z=Object(r.useCallback)((function(){e.length&&g((function(t){return!t}))}),[e]),I=Object(r.useRef)(),B=Object(r.useCallback)((function(){if(e.length){var t=V(e),n=1e3*e[0].svg.getCurrentTime(),r=t.find((function(t){return t>n+50}));r?r-=1:r=n+500,clearTimeout(I.current),e.forEach((function(t){t.svg.unpauseAnimations()})),I.current=setTimeout((function(){e.forEach((function(t){var e=t.svg;e.pauseAnimations(),e.setCurrentTime(r/1e3)})),g(!0)}),r-n)}}),[e]),G=Object(r.useCallback)((function(){e.forEach((function(t){t.svg.setCurrentTime(0)}))}),[e]);Object(r.useEffect)((function(){var t=function(t){"p"===t.key.toLowerCase()?z():"s"===t.key.toLowerCase()?B():"r"===t.key.toLowerCase()?G():"q"===t.key.toLowerCase()?u((function(t){return"boolean"===typeof t?!t:t})):u((function(t){return"boolean"===typeof t||t}))};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[z,B,G]);var Z=function(){var t=Object(f.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.length){t.next=2;break}return t.abrupt("return");case 2:if(!E){t.next=6;break}return t.next=5,D(E);case 5:return t.abrupt("return");case 6:return O(!0),u(!1),t.prev=8,t.next=11,R(e);case 11:n=t.sent,M(n),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(8),console.log(t.t0);case 18:u(!0),O(!1);case 20:case"end":return t.stop()}}),t,null,[[8,15]])})));return function(){return t.apply(this,arguments)}}();return!0!==i?null:Object(p.jsxs)("div",{className:"Toolbar",children:[Object(p.jsxs)("div",{className:"Toolbar-loader",children:[Object(p.jsx)("button",{type:"button",onClick:L,children:"Load File"}),Object(p.jsx)("span",{children:"OR"}),Object(p.jsx)("button",{type:"button",onClick:P,children:"Load Library"}),Object(p.jsx)("span",{children:"OR"}),Object(p.jsxs)("form",{onSubmit:function(t){t.preventDefault();var e=W.exec(y);e?(e[1]?window.location.hash=e[0]:window.location.hash="library=".concat(e[0]),window.location.reload()):window.alert("Invalid link")},children:[Object(p.jsx)("input",{placeholder:"Enter link...",value:y,onChange:function(t){return C(t.target.value)}}),Object(p.jsx)("button",{type:"submit",disabled:!W.test(y),children:"Animate!"})]})]}),!!e.length&&Object(p.jsxs)("div",{className:"Toolbar-controller",children:[Object(p.jsx)("button",{type:"button",onClick:z,children:v?"Play (P)":"Pause (P)"}),Object(p.jsx)("button",{type:"button",onClick:B,children:"Step (S)"}),Object(p.jsx)("button",{type:"button",onClick:G,children:"Reset (R)"}),Object(p.jsx)("button",{type:"button",onClick:function(){u((function(t){return"boolean"!==typeof t&&t}))},children:"Hide Toolbar (Q)"}),Object(p.jsx)("button",{type:"button",onClick:function(){e.length&&e.forEach((function(t){var e=t.svg;T(e)}))},children:"Export to SVG"}),Object(p.jsx)("button",{type:"button",onClick:Z,disabled:x,children:x?"Processing...":E?"Export to WebM":"Prepare WebM"})]}),Object(p.jsx)(h,{link:"https://github.com/dai-shi/excalidraw-animate",size:40})]})},_=(n(48),function(t){var e=t.svgList,n=Object(r.useRef)(null);Object(r.useEffect)((function(){return e.forEach((function(t){var e=t.svg;n.current&&n.current.appendChild(e)})),function(){e.forEach((function(t){t.svg.remove()}))}}),[e]),Object(r.useEffect)((function(){var t=window.location.hash.slice(1);if("no"===new URLSearchParams(t).get("autoplay")&&n.current){var r=n.current,a=function(){e.forEach((function(t){var e=t.svg;e.setCurrentTime(0),e.unpauseAnimations()}))};return r.addEventListener("click",a),function(){r.removeEventListener("click",a)}}}),[e]);var a=Math.ceil(Math.sqrt(e.length)),c="repeat(".concat(a,", ").concat(100/a,"%)");return Object(p.jsx)("div",{className:"Viewer",style:{gridTemplateColumns:c,gridTemplateRows:c},ref:n})}),q=function(){var t=function(){var t=Object(r.useState)(!0),e=Object(o.a)(t,2),n=e[0],a=e[1],c=Object(r.useState)([]),i=Object(o.a)(c,2),u=i[0],s=i[1],b=Object(r.useCallback)(function(){var t=Object(f.a)(l.a.mark((function t(e,n){var r,a,c,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=window.location.hash.slice(1),a=new URLSearchParams(r),c={startMs:void 0,pointerImg:a.get("pointerImg")||void 0,pointerWidth:a.get("pointerWidth")||void 0,pointerHeight:a.get("pointerHeight")||void 0},t.next=5,Promise.all(e.map(function(){var t=Object(f.a)(l.a.mark((function t(e){var r,a,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=F(e.elements),t.next=3,Object(d.exportToSvg)({elements:r,files:e.files,appState:{exportBackground:!0,viewBackgroundColor:"white"},exportPadding:30});case 3:return a=t.sent,i=L(a,r,c),console.log(a),n&&(c.startMs=i.finishedMs),t.abrupt("return",{svg:a,finishedMs:i.finishedMs});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 5:return i=t.sent,s(i),t.abrupt("return",i);case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),[]);return Object(r.useEffect)((function(){Object(f.a)(l.a.mark((function t(){var e,n,r,c,i,u,s,f,d,p,h,m,v,g,w,j,x;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=window.location.hash.slice(1),n=new URLSearchParams(e),!(r=/([0-9]+),?([a-zA-Z0-9_-]*)/.exec(n.get("json")||""))){t.next=16;break}return c=Object(o.a)(r,3),i=c[1],u=c[2],t.next=7,B(i,u,null);case 7:return s=t.sent,t.next=10,b([s]);case 10:f=t.sent,d=Object(o.a)(f,1),p=d[0],h=p.svg,m=p.finishedMs,"no"===n.get("autoplay")&&h.setCurrentTime(m);case 16:if(!(v=/(.*\.excalidrawlib)/.exec(n.get("library")||""))){t.next=26;break}return g=Object(o.a)(v,2),w=g[1],t.next=21,G(w);case 21:return j=t.sent,t.next=24,b(j.map((function(t){return{elements:t,files:{}}})),n.has("sequence"));case 24:x=t.sent,"no"===n.get("autoplay")&&x.forEach((function(t){var e=t.svg,n=t.finishedMs;e.setCurrentTime(n)}));case 26:a(!1);case 27:case"end":return t.stop()}}),t)})))()}),[b]),{loading:n,loadedSvgList:u,loadDataList:b}}(),e=t.loading,n=t.loadedSvgList,a=t.loadDataList;return e?Object(p.jsx)("div",{children:"Loading..."}):Object(p.jsxs)("div",{className:"App",children:[Object(p.jsx)(Z,{svgList:n,loadDataList:a}),!!n.length&&Object(p.jsx)(_,{svgList:n})]})};i.a.render(Object(p.jsx)(a.a.StrictMode,{children:Object(p.jsx)(q,{})}),document.getElementById("root"))}},[[49,1,2]]]);
//# sourceMappingURL=main.5674e4bf.chunk.js.map